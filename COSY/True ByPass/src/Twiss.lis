 --- BIN FILE READ: BYPASS_3_quad_SEQ_maps
  11578 INCLUDE 'BYPASS_3_quad_SEQ_maps';
  11579   PROCEDURE PICK INDEX MAPARR SPNRARR;
  11580     VARIABLE I 1;
  11581     VARIABLE J 1;
  11582     LOOP I 1 TWOND;
  11583       MSC(I) := MAPARR(I, INDEX);
  11584       ENDLOOP;
  11585     LOOP I 1 3;
  11586       LOOP J 1 3;
  11587         SSCR(I,J) := SPNRARR(I,J,INDEX) + 0*DD(1);
  11588         ENDLOOP;
  11589       ENDLOOP;
  11590     ENDPROCEDURE;
  11591   PROCEDURE MAKEMAP FROM TO START MAPARR SPNRARR;
  11592     VARIABLE J 1;
  11593     WRITE 6 '* '&ST(START);
  11594     LMAPS START MAPARR SPNRARR; %LMAPS:10125
  11595     LOOP J (START+1) TO;
  11596       WRITE 6 '**       '&ST(J);
  11597       PICK J MAPARR SPNRARR; %PICK:11579
  11598       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  11599       UPDATE 1 1; %UPDATE: 1261
  11600       ENDLOOP;
  11601     LOOP J FROM (START-1);
  11602       WRITE 6 '**       '&ST(J);
  11603       PICK J MAPARR SPNRARR; %PICK:11579
  11604       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  11605       UPDATE 1 1; %UPDATE: 1261
  11606       ENDLOOP;
  11607     ENDPROCEDURE;
  11608   PROCEDURE GETTWISS0 COORD AL0 BET0 GAM0 MAPARR SPNRARR;
  11609     VARIABLE NUM1 1;
  11610     VARIABLE NUM2 1;
  11611     VARIABLE OBJ 1;
  11612     IF COORD='X';
  11613       NUM1:=1;
  11614       NUM2:=2;
  11615       AL0:=0;
  11616       BET0:=20.0;
  11617       GAM0:=1.0/BET0;
  11618       ELSEIF COORD='Y';
  11619       NUM1:=3;
  11620       NUM2:=4;
  11621       AL0:=0;
  11622       BET0:=3;
  11623       GAM0:=1.0/BET0;
  11624       ELSEIF LO(1);
  11625       WRITE 6 'UNKNOWN COORDINATE';
  11626       ENDIF;
  11627     FIT AL0 BET0 GAM0;
  11628       OBJ:= SQR(SQR(ME(NUM1,NUM1))*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+SQR(ME(NUM1,NUM2))*GAM0-BET0); %ME:  516 %ME:  516 %ME: 
                   516 %ME:  516
  11629       OBJ:=OBJ+ SQR(-ME(NUM1,NUM1)*ME(NUM2,NUM1)*BET0+( ME(NUM1,NUM1)*
                  ME(NUM2,NUM2)+ME(NUM1,NUM2)*ME(NUM2,NUM1) )*AL0-ME(NUM1,NUM2
                  )*ME(NUM2,NUM2)*GAM0-AL0); %ME:  516 %ME:  516 %ME:  516 %ME
                  :  516 %ME:  516 %ME:  516 %ME:  516 %ME:  516
  11630       OBJ:=OBJ+ SQR((ME(NUM2,NUM1)^2)*BET0-2*ME(NUM2,NUM1)*ME(NUM2,NUM
                  2)*AL0+(ME(NUM2,NUM2)^2)*GAM0-(1+AL0^2)/BET0)  ; %ME:  516 %
                  ME:  516 %ME:  516 %ME:  516
  11631       ENDFIT 1E-20 5000 1 OBJ;
  11632     ENDPROCEDURE;
  11633   PROCEDURE BETS TAG COORD NUM_ELE AL0 BET0 GAM0 BETS MAPARR SPNRARR;
  11634     VARIABLE J 1;
  11635     VARIABLE NUM1 1;
  11636     VARIABLE NUM2 1;
  11637     IF COORD='X';
  11638       NUM1:=1;
  11639       NUM2:=2;
  11640       ELSEIF COORD='Y';
  11641       NUM1:=3;
  11642       NUM2:=4;
  11643       ELSEIF LO(1);
  11644       WRITE 6 'UNKNOWN COORDINATE';
  11645       ENDIF;
  11646     UM; %UM: 1488
  11647     BETS(1):=BET0;
  11648     OPENF 800 TAG 'REPLACE';
  11649     WRITE 800 ST(BETS(1))&'     '&ST(0);
  11650     LOOP J 1 NUM_ELE;
  11651       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:11591
  11652       BETS(J+1):=(ME(NUM1,NUM1)^2)*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+(ME(NUM1,NUM2)^2)*GAM0; %ME:  516 %ME:  516 %ME:  516 %M
                  E:  516
  11653       WRITE 800 ST(BETS(J+1))&'     '&ST(J);
  11654       UM; %UM: 1488
  11655       ENDLOOP;
  11656     CLOSEF 800;
  11657     ENDPROCEDURE;
  11658   PROCEDURE GETDISP0 COORD D0 DPR0 MAPARR SPNRARR;
  11659     VARIABLE NUM1 1;
  11660     VARIABLE NUM2 1;
  11661     VARIABLE OBJ 1;
  11662     IF COORD='X';
  11663       NUM1:=1;
  11664       NUM2:=2;
  11665       D0:=0;
  11666       DPR0:=0;
  11667       ELSEIF COORD='Y';
  11668       NUM1:=3;
  11669       NUM2:=4;
  11670       D0:=0;
  11671       DPR0:=0;
  11672       ELSEIF LO(1);
  11673       WRITE 6 'UNKNOWN COORDINATE';
  11674       ENDIF;
  11675     FIT D0 DPR0;
  11676       OBJ:= SQR(  ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ME(NUM1,6)*(1+1/
                  (CONS(ETA)+1))-D0  ); %ME:  516 %ME:  516 %ME:  516
  11677       OBJ:=OBJ+ SQR(  ME(NUM2,NUM1)*D0+ME(NUM2,NUM2)*DPR0+ME(NUM2,6)*(
                  1+1/(CONS(ETA)+1))-DPR0  )  ; %ME:  516 %ME:  516 %ME:  516
  11678       ENDFIT 1E-20 5000 1 OBJ;
  11679     WRITE 6 'DISP'&COORD&'0' 'DISP_PRIME'&COORD&'0';
  11680     WRITE 6 D0 DPR0;
  11681     ENDPROCEDURE;
  11682   PROCEDURE DISPS TAG COORD NUM_ELE D0 DPR0 DS MAPARR SPNRARR;
  11683     VARIABLE J 1;
  11684     VARIABLE NUM1 1;
  11685     VARIABLE NUM2 1;
  11686     IF COORD='X';
  11687       NUM1:=1;
  11688       NUM2:=2;
  11689       ELSEIF COORD='Y';
  11690       NUM1:=3;
  11691       NUM2:=4;
  11692       ELSEIF LO(1);
  11693       WRITE 6 'UNKNOWN COORDINATE';
  11694       ENDIF;
  11695     UM; %UM: 1488
  11696     DS(1):=D0;
  11697     OPENF 800 TAG 'REPLACE';
  11698     WRITE 800 ST(DS(1))&'     '&ST(0);
  11699     LOOP J 1 NUM_ELE;
  11700       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:11591
  11701       DS(J+1):=ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ ME(NUM1,6)*(1+1/(C
                  ONS(ETA)+1)); %ME:  516 %ME:  516 %ME:  516
  11702       WRITE 800 ST(DS(J+1))&'     '&ST(J);
  11703       UM; %UM: 1488
  11704       ENDLOOP;
  11705     CLOSEF 800;
  11706     ENDPROCEDURE;
  11707   PROCEDURE MAIN;
  11708     VARIABLE GAMMA 1;
  11709     VARIABLE SGX1 1;
  11710     VARIABLE SGX2 1;
  11711     VARIABLE SGY1 1;
  11712     VARIABLE SGY2 1;
  11713     VARIABLE EB1 1;
  11714     VARIABLE ALPHAX0 1;
  11715     VARIABLE BETAX0 1;
  11716     VARIABLE GAMMAX0 1;
  11717     VARIABLE BETAXS 1 313;
  11718     VARIABLE ALPHAY0 1;
  11719     VARIABLE BETAY0 1;
  11720     VARIABLE GAMMAY0 1;
  11721     VARIABLE BETAYS 1 313;
  11722     VARIABLE DISPX0 1;
  11723     VARIABLE DISPXPR0 1;
  11724     VARIABLE DISPXS 1 313;
  11725     VARIABLE DISPY0 1;
  11726     VARIABLE DISPYPR0 1;
  11727     VARIABLE DISPYS 1 313;
  11728     VARIABLE MAPARR1 1000 6 313;
  11729     VARIABLE SPNRARR1 1000 3 3 313;
  11730     VARIABLE NUM_ELE 1;
  11731     GAMMA := 1.12792344429;
  11732     NUM_ELE := 313;
  11733     OV 3 3 0; %OV:  969
  11734     SET_FOR_DEUTERONS GAMMA; %SET_FOR_DEUTERONS:10561
  11735     EB1 := 99.04;
  11736     SGX1 :=  5.0E-003;
  11737     SGY1 := -9.6E-003;
  11738     ALPHAX0:=-0.730891;
  11739     BETAX0:=8.51169;
  11740     GAMMAX0:=(1+SQR(ALPHAX0))/BETAX0;
  11741     ALPHAY0:=1.68832;
  11742     BETAY0:=14.7225;
  11743     GAMMAY0:=(1+SQR(ALPHAY0))/BETAY0;
  11744     DISPX0:=0.00436536;
  11745     DISPXPR0:=0.00016190;
  11746     DISPY0:=0.0;
  11747     DISPYPR0:=0.0;
  11748     LATTICE SGX1 SGY1 EB1 0 MAPARR1 SPNRARR1; %LATTICE:10580
  11749     PM 6; %PM: 1574
  11750     WRITE 6 '++++++++++ Magnetic Rigidity';
  11751     WRITE 6 CONS(CHIM);
  11752     WRITE 6 ME(3,6); %ME:  516
  11753     DISPS 'DISPX_3_quad' 'X' NUM_ELE DISPX0 DISPXPR0 DISPXS MAPARR1 SP
                  NRARR1; %DISPS:11682
  11754     DISPS 'DISPY_3_quad' 'Y' NUM_ELE DISPY0 DISPYPR0 DISPYS MAPARR1 SP
                  NRARR1; %DISPS:11682
  11755     ENDPROCEDURE;
  11756   PROCEDURE RUN;
  11757     MAIN; %MAIN:11707
  11758     ENDPROCEDURE;
  11759   RUN; %RUN:11756
